"use strict";function routeConfig(a,b){a.state("home",{url:"/",templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"ctrl"}).state("history",{url:"/history/:river",templateUrl:"views/history.html",controller:"HistoryCtrl",controllerAs:"ctrl"}),b.otherwise("/")}angular.module("alertasEnchentesApp",["ngAnimate","ngSanitize","ngTouch","ngResource","ui.router","openlayers-directive"]).constant("RESTAPI",{url:"http://enchentes.infoamazonia.org:8080"}).config(routeConfig),routeConfig.$inject=["$stateProvider","$urlRouterProvider"],function(){function a(a,b,c,d){function e(){}function f(a){for(var b=0;b<i.rivers.length;b++)if(i.rivers[b].slug===a){i.select=!0,i.loading=!0,i.selectedRiver=i.rivers[b],d.get({id:i.rivers[b].station},function(a){i.timestamp=moment().format("H:mm"),i.selectedRiver.data=a,i.selectedRiver.alert=h(i.selectedRiver.data),i.loading=!1},function(a){i.timestamp=moment().format("H:mm"),i.selectedRiver.data={},i.selectedRiver.alert={title:"--",description:"Não foi possível obter dados de previsão",timestamp:null},i.loading=!1});break}}function g(a){return i.selectedRiver.slug===a}function h(a){if(!a.data.length)return{title:"--",description:"Não foi possível obter dados",timestamp:null};for(var b=0,c=0;c<a.data.length;c++)a.data[c].predicted&&b++;if(!b)return{title:"--",description:"Não foi possível obter dados de previsão",timestamp:null};for(var c=0;c<a.data.length;c++)if(a.data[c].predicted>=a.info.floodThreshold)return{title:"Alerta de enchente",description:"Ação evasiva é recomendada",timestamp:data[c].id.timestamp};for(var c=0;c<a.data.length;c++)if(a.data[c].predicted>=a.info.warningThreshold)return{title:"Alerta de cheia",description:"Esteja preparado",timestamp:data[c].id.timestamp};return{title:"Dia normal",description:"Nenhuma alta prevista para as próximas horas",timestamp:null}}var i=this;i.loading=!1,i.select=!1,i.rivers=[{slug:"rioacre",name:"Rio Acre",station:13600002,history:{},data:{},alert:{}},{slug:"riomadeira",name:"Rio Madeira",station:154e5,history:{},data:{},alert:{}},{slug:"manaus",name:"Rio Amazonas",station:1499e4,history:{},data:{},alert:{}}],i.timestamp=moment().format("H:mm"),i.selectedRiver={},i.selectRiver=f,i.isSelectedRiver=g;var j=$(window).width()<=998;i.map={center:{lat:-6,lon:-70,zoom:j?4:6},layers:[{name:"Satellite",active:!0,source:{type:"MapBox",mapId:"mapbox.satellite",accessToken:"pk.eyJ1IjoiamVmZmVyc29ucnBuIiwiYSI6ImNpcnZhc2FoMTBpZGtmYW04M3IyZTZ6NWoifQ.xTtlY-a--vOAS25Op_7uIA"}},{name:"Stations",active:!0,source:{type:"GeoJSON",url:"/stations.js"},style:{fill:{color:"rgba(0, 0, 0, 0)"}}}],markers:[{lat:-9.972892,lon:-67.791799,label:{message:"Rio Acre",show:!0,showOnMouseOver:!0}},{lat:-8.748149,lon:-63.917471,label:{message:"Rio Madeira",show:!0,showOnMouseOver:!0}},{lat:-3.1383,lon:-60.0272,label:{message:"Rio Amazonas",show:!0,showOnMouseOver:!0}}],defaults:{events:{layers:["click"],map:["pointermove"]},controls:{zoom:!1,rotate:!1,attribution:!1},interactions:{mouseWheelZoom:!1},view:{maxZoom:16,minZoom:4}}},e();var k=angular.element(b),l=function(){a.scroll=k.scrollTop()};k.on("scroll",a.$apply.bind(a,l)),l(),a.$on("openlayers.layers.Stations.click",function(b,c){a.$apply(function(a){c&&f(c.get("river"))})}),a.$on("openlayers.map.pointermove",function(b,d){a.$apply(function(){c.getMap().then(function(a){var b=a.getEventPixel(d.event.originalEvent),c=a.forEachFeatureAtPixel(b,function(b,c){return"Stations"===c.get("name")&&(a.getTarget().style.cursor="pointer",!0)});if("undefined"==typeof c)return void(a.getTarget().style.cursor="")})})})}angular.module("alertasEnchentesApp").controller("MainCtrl",a),a.$inject=["$scope","$window","olData","Prediction"]}(),function(){function a(a,b,c,d){function e(){var a="rioacre";c.river&&(a=c.river),f(a)}function f(a){for(var b=0;b<h.rivers.length;b++)if(h.rivers[b].slug===a){h.selectedRiver=h.rivers[b],h.loading=!0,d.get({id:h.selectedRiver.station},function(a){h.selectedRiver.history=a,h.loading=!1});break}}function g(a){return h.selectedRiver.slug===a}var h=this;h.loading=!0,h.rivers=[{slug:"rioacre",name:"Rio Acre",station:13600002,history:{}},{slug:"riomadeira",name:"Rio Madeira",station:154e5,history:{}},{slug:"rioamazonas",name:"Rio Amazonas",station:1499e4,history:{}}],h.selectedRiver={},h.selectRiver=f,h.isSelectedRiver=g,e();var i=angular.element(b),j=function(){a.scroll=i.scrollTop()};i.on("scroll",a.$apply.bind(a,j)),j()}angular.module("alertasEnchentesApp").controller("HistoryCtrl",a),a.$inject=["$scope","$window","$stateParams","History"]}(),function(){function a(){return{template:"<svg></svg>",restrict:"E",scope:{river:"="},link:function(a,b){function c(a){function b(a,b){var c=Math.abs(b.getTime()-a.getTime());return Math.ceil(c/864e5)}function c(){x.empty()?(q.domain(r.domain()),O={data:null,min:null,max:null},P.text(""),Q.text(""),G.transition(500).attr("opacity",0)):(q.domain(x.extent()),O=d(R,x.extent()),P.text("Máxima de "+O.max.value+"m"),Q.text("Mínima de "+O.min.value+"m"),P.attr("transform","translate("+q(O.max.date)+","+s(O.max.value)+")"),Q.attr("transform","translate("+q(O.min.date)+","+s(O.min.value)+")"),G.transition(1e3).attr("opacity",1),G.select(".dots.line-max").attr("x1",q(O.max.date)).attr("y1",s(O.max.value)-30).attr("x2",q(O.max.date)).attr("y2",s(O.max.value)),G.select(".dots.line-min").attr("x1",q(O.min.date)).attr("y1",s(O.min.value)-30).attr("x2",q(O.min.date)).attr("y2",s(O.min.value))),C.select(".area").attr("d",y(R)),C.select(".area.area-null").attr("d",y(U)),C.select(".line").attr("d",z(R)),C.select(".x.axis").call(u)}function f(){I.style("display",null)}function g(){I.style("display","none")}function o(){var a=q.invert(e.mouse(this)[0]),b=n(R,a,1),c=R[b-1],d=R[b],f=a-c.date>d.date-a?d:c;K.attr("transform","translate("+q(f.date)+","+s(f.measured)+")"),J.attr({x1:q(f.date),y1:s(Y)-m,x2:q(f.date),y2:s(0)}),M.attr("transform","translate("+q(f.date)+","+(s(Y)-l/2-m)+")"),M.text(f.measured+"m em "+p(f.date)),L.attr({x:q(f.date)-k/2,y:s(Y)-l-m})}function B(){x.extent([new Date(this.innerHTML+"-01-01"),new Date(this.innerHTML+"-12-31")]),x(e.select(".brush").transition()),x.event(e.select(".brush").transition())}var R=[];a.data.forEach(function(a){a.measured&&R.push({date:new Date(a.timestamp),measured:Math.round(.01*a.measured*100)/100})});var S=Math.round(.01*a.info.warningThreshold*100)/100,T=Math.round(.01*a.info.floodThreshold*100)/100;R.sort(function(a,b){return a.date-b.date});for(var U=[],V=0;V<R.length-1;V++){if(U.push(R[V]),b(R[V+1].date,R[V].date)>30){var W={date:R[V].date,measured:null};U.push(W);var X={date:R[V+1].date,measured:null};U.push(X)}R.length-2===V&&U.push(R[V+1])}var Y=e.max(R.map(function(a){return a.measured})),Z=e.extent(R.map(function(a){return a.date})),$=Z,_=R[R.length-1].date,aa=new Date(_);aa=new Date(aa.setMonth(aa.getMonth()-120)),$=[aa,_],q.domain(Z),s.domain([0,Y]),r.domain(q.domain()),t.domain(s.domain()),D.attr("d",y(R)),E.attr("d",y(U)),F.attr("d",z(R)),S>0&&C.append("line").attr("class","warning-line").attr("x1",0).attr("y1",s(S)).attr("x2",h).attr("y2",s(S)),T>0&&C.append("line").attr("class","flood-line").attr("x1",0).attr("y1",s(T)).attr("x2",h).attr("y2",s(T)),G.append("line").attr("class","dots line-max"),G.append("line").attr("class","dots line-min"),C.append("g").attr("class","x axis").attr("transform","translate(0,"+i+")").call(u),C.append("g").attr("class","y axis").call(w).append("text").attr("y",6).attr("dy",".71em").style("text-anchor","end").attr("transform","rotate(-90)").text("Volume (m)"),N.append("path").datum(R).attr("class","area2").attr("d",A),N.append("g").attr("class","x axis").attr("transform","translate(0,"+j+")").call(v),N.selectAll(".tick text").on("click",B),N.append("g").attr("class","x brush").call(x).selectAll("rect").attr("y",-6).attr("height",j+7),H.on("mouseover",f).on("mouseout",g).on("mousemove",o),x.extent($),x.on("brush",c),N.select(".brush").call(x),c()}function d(a,b){var c;_.find(a,function(a,d){return c=d,b[0].getFullYear()===a.date.getFullYear()&&b[0].getMonth()===a.date.getMonth()});var d=_.rest(a,c),e=[];_.find(d,function(a){return e.push(a),b[1].getFullYear()===a.date.getFullYear()&&b[1].getMonth()===a.date.getMonth()});var f,g,h=-9999,i=9999;return _.each(e,function(a){a.measured>h&&(h=a.measured,f=a.date),a.measured<i&&(i=a.measured,g=a.date)}),{data:e,min:{value:i,date:g},max:{value:h,date:f}}}var e=d3,f={top:80,right:10,bottom:100,left:40},g={top:430,right:10,bottom:20,left:40},h=1960-f.left-f.right,i=500-f.top-f.bottom,j=500-g.top-g.bottom,k=300,l=30,m=45,n=e.bisector(function(a){return a.date}).left,o=e.locale({decimal:",",thousands:".",grouping:[3],currency:["R$",""],dateTime:"%d/%m/%Y %H:%M:%S",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]}),p=o.timeFormat("%d de %B  de %Y"),q=e.time.scale().range([0,h]),r=e.time.scale().range([0,h]),s=e.scale.linear().range([i,0]),t=e.scale.linear().range([j,0]),u=e.svg.axis().scale(q),v=e.svg.axis().scale(r).orient("bottom").ticks(e.time.year),w=e.svg.axis().scale(s).orient("left"),x=e.svg.brush().x(r),y=e.svg.area().x(function(a){return q(a.date)}).y0(i).y1(function(a){return s(a.measured)}),z=e.svg.line().defined(function(a){return a.measured}).x(function(a){return q(a.date)}).y(function(a){return s(a.measured)}),A=e.svg.area().interpolate("monotone").x(function(a){return r(a.date)}).y0(j).y1(function(a){return t(a.measured)}),B=e.select("svg").attr({class:"timeline-chart",version:"1.1",viewBox:"0 0 "+(h+f.left+f.right)+" "+(i+f.top+f.bottom),width:"100%"});B.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",h).attr("height",i+f.top).attr("transform","translate(0,"+-f.top+")");var C=B.append("g").attr("class","focus").attr("transform","translate("+f.left+","+f.top+")"),D=C.append("path").attr("class","area"),E=C.append("path").attr("class","area area-null"),F=C.append("path").attr("class","line"),G=C.append("g").attr("class","dots").attr("opacity",0),H=C.append("rect").attr("width",h).attr("height",i).style("fill","none").style("pointer-events","all"),I=C.append("g").attr("class","selected-value").style("display","none"),J=I.append("line"),K=I.append("g");K.append("circle").attr("r",8),K.append("circle").attr("r",5);var L=I.append("rect").attr("rx",4).attr("ry",4).attr("width",k).attr("height",l),M=I.append("text").attr("x",9).attr("dy",".35em").attr("text-anchor","middle"),N=B.append("g").attr("class","context").attr("transform","translate("+g.left+","+g.top+")"),O={data:null,min:null,max:null},P=B.append("text").attr("class","legend").attr("x",f.left+4).attr("y",50).attr("text-anchor","start").attr("alignment-baseline","hanging").text(""),Q=B.append("text").attr("class","legend").attr("x",f.left+4).attr("y",50).attr("text-anchor","start").attr("alignment-baseline","hanging").text("");a.$watch(function(a){return a.river},function(a){"undefined"!=typeof a&&a.data&&c(a)})}}}angular.module("alertasEnchentesApp").directive("aeHistory",a),a.$inject=[]}(),function(){function a(a){return{templateUrl:"views/directives/ae-navbar.html",restrict:"E",scope:{scroll:"=scrollPosition",selectRiver:"&"},link:function(b,c,d){var e=angular.element(a),f=function(){b.scroll=e.scrollTop()};e.on("scroll",b.$apply.bind(b,f)),f()}}}angular.module("alertasEnchentesApp").directive("aeNavbar",a),a.$inject=["$window"]}(),function(){function a(){return{template:"<svg></svg>",restrict:"E",scope:{river:"="},link:function(a,b){function c(a){function b(){J.style("display",null)}function c(){J.style("display","none")}function d(){var a=p.invert(e.mouse(this)[0]),b=n(f,a,1),c=f[b-1],d=f[b],g=a-c.timestamp>d.timestamp-a?d:c,i=Math.round(.01*g.measured*100)/100;L.attr("transform","translate("+p(g.timestamp)+","+q(g.measured)+")"),K.attr({x1:p(g.timestamp),y1:q(h)-m,x2:p(g.timestamp),y2:q(0)}),N.attr("transform","translate("+p(g.timestamp)+","+(q(h)-l/2-m)+")"),N.text(i+"m em "+o(g.timestamp)),M.attr({x:p(g.timestamp)-k/2,y:q(h)-l-m}),e.select(".alert-measure").text(i+"m"),e.select(".alert-time").text(o(g.timestamp))}if(!(a.data.length<1)){var f=[],g=[];a.data.forEach(function(a){a.timestamp=new Date(1e3*a.timestamp),null!==a.measured&&f.push(a),null!==a.predicted&&g.push(a)});var h=e.max(f,function(a){return a.measured});if(h<a.info.floodThreshold)var h=a.info.floodThreshold;p.domain(d3.extent(a.data,function(a){return a.timestamp})),q.domain([0,h]),r.y0(q(0)),E.attr({y1:q(a.info.warningThreshold),y2:q(a.info.warningThreshold)}),F.attr({y:q(a.info.warningThreshold)+12}),G.attr({y1:q(a.info.floodThreshold),y2:q(a.info.floodThreshold)}),H.attr({y:q(a.info.floodThreshold)-4}),z.datum(f).attr("d",r),A.datum(f).attr("d",s),B.datum(g).attr("d",t),C.call(u),D.call(v),I.on("mouseover",b).on("mouseout",c).on("mousemove",d)}}function d(a){switch(a){case"NORMAL":return"#1878f0";case"ALERTA":return"#faea59";case"INUNDACAO":return"#eb533e";default:return"#1878f0"}}var e=d3,f={top:50,right:10,bottom:30,left:30},g=600-f.left-f.right,h=300-f.top-f.bottom,i=g+f.left+f.right,j=h+f.top+f.bottom,k=170,l=30,m=-50,n=e.bisector(function(a){return a.timestamp}).left,o=d3.time.format("%Hh%M"),p=e.time.scale().range([0,g]),q=e.scale.linear().range([h,0]),r=e.svg.area().x(function(a){return p(a.timestamp)}).y1(function(a){return q(a.measured)}),s=e.svg.line().x(function(a){return p(a.timestamp)}).y(function(a){return q(a.measured)}),t=e.svg.line().x(function(a){return p(a.timestamp)}).y(function(a){return q(a.predicted)}),u=e.svg.axis().scale(p).orient("bottom").ticks(12).tickFormat(d3.time.format("%Hh")),v=e.svg.axis().scale(q).orient("left").ticks(12).tickFormat(function(a){return Math.round(.01*a*100)/100}),w=e.select("svg").attr({class:"timeline-chart",version:"1.1",viewBox:"0 0 "+i+" "+j,width:"100%"}).append("g").attr("transform","translate("+f.left+","+f.top+")"),x=w.append("g").attr("class","areaG"),y=w.append("g").attr("class","lines"),z=x.append("path").attr("class","area"),A=x.append("path").attr("class","line"),B=x.append("path").attr("class","line2"),C=x.append("g").attr("transform","translate(0,"+h+")").attr("class","x axis"),D=x.append("g").attr("class","y axis"),E=y.append("line").attr({x1:0,x2:g,fill:"none","stroke-width":"2px",opacity:.5,"stroke-dasharray":"10,5",stroke:d("ALERTA")}),F=y.append("text").attr({x:f.right,fill:d("ALERTA"),opacity:.5,"font-size":"10","font-family":"sans"}).text("Nível de alerta"),G=y.append("line").attr({fill:"none",x1:0,x2:g,"stroke-width":"2px",opacity:.5,"stroke-dasharray":"10,5",stroke:d("INUNDACAO")}),H=y.append("text").attr({x:f.right,fill:d("INUNDACAO"),opacity:.5,"font-size":"10","font-family":"sans"}).text("Nível de enchente"),I=(w.append("g").attr("class","dots").attr("opacity",0),w.append("rect").attr("width",g).attr("height",h).style("fill","none").style("pointer-events","all")),J=w.append("g").attr("class","selected-value").style("display","none"),K=J.append("line"),L=J.append("g");L.append("circle").attr("r",8),L.append("circle").attr("r",5);var M=J.append("rect").attr("rx",4).attr("ry",4).attr("width",k).attr("height",l),N=J.append("text").attr("x",5).attr("dy",".35em").attr("text-anchor","middle");a.$watch(function(a){return a.river},function(a){"undefined"!=typeof a&&a.data&&c(a)})}}}angular.module("alertasEnchentesApp").directive("aePrediction",a),a.$inject=[]}(),function(){function a(a,b){return b(a.url+"/station/:id/history")}angular.module("alertasEnchentesApp").factory("History",a),a.$inject=["RESTAPI","$resource"]}(),function(){function a(a,b){return b(a.url+"/station/:id/prediction")}angular.module("alertasEnchentesApp").factory("Prediction",a),a.$inject=["RESTAPI","$resource"]}(),angular.module("alertasEnchentesApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/directives/ae-navbar.html",'<nav class="navbar navbar-fixed-top" ng-class="{\'navbar-inverse\': scroll > 150, \'navbar-default\': scroll <= 150}"> <div class="container-fluid"> <!-- Brand and toggle get grouped for better mobile display --> <div class="navbar-header"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" ui-sref="home"> <img src="images/ia-white.2cc19e45.png" alt="Infoamazônia" width="185" height="40"> </a> </div> <!-- Collect the nav links, forms, and other content for toggling --> <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"> <ul class="nav navbar-nav navbar-right"> <li><a ui-sref="riobranco">Rio Branco</a></li> <li><a ui-sref="portovelho">Porto Velho</a></li> <li><a ui-sref="manaus">Manaus</a></li> </ul> </div><!-- /.navbar-collapse --> </div><!-- /.container-fluid --> </nav>'),a.put("views/history.html",'<nav class="navbar navbar-fixed-top" ng-class="{\'navbar-inverse\': scroll > 150, \'navbar-default\': scroll <= 150}"> <div class="container-fluid"> <!-- Brand and toggle get grouped for better mobile display --> <div class="navbar-header"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" ui-sref="home"> <img src="images/ia-white.2cc19e45.png" alt="Infoamazônia" width="185" height="40"> </a> </div> <!-- Collect the nav links, forms, and other content for toggling --> <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"> <ul class="nav navbar-nav navbar-right"> <li class="dropdown"> <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Previsões <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a href="" ng-click="ctrl.selectRiver(\'rioacre\')">Rio Acre</a></li> <li><a href="" ng-click="ctrl.selectRiver(\'riomadeira\')">Rio Madeira</a></li> </ul> </li> <li class="dropdown"> <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Séries históricas <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a ui-sref="history({river: \'rioacre\'})">Rio Acre</a></li> <li><a ui-sref="history({river: \'riomadeira\'})">Rio Madeira</a></li> <li><a ui-sref="history({river: \'rioamazonas\'})">Rio Amazonas</a></li> </ul> </li> </ul> </div><!-- /.navbar-collapse --> </div><!-- /.container-fluid --> </nav> <div class="content-main section-primary"> <div class="container-fluid"> <h2 class="text-center">Série histórica do {{ctrl.selectedRiver.name}}</h2> <div class="loading" ng-show="ctrl.loading"> <div class="loading-speeding-wheel"></div> </div> <!-- {{ctrl.selectedRiver.history | json}} --> <ae-history river="ctrl.selectedRiver.history"></ae-history> </div> </div>'),a.put("views/main.html",'<nav class="navbar navbar-fixed-top" ng-class="{\'navbar-inverse\': scroll > 150, \'navbar-default\': scroll <= 150}"> <div class="container-fluid"> <!-- Brand and toggle get grouped for better mobile display --> <div class="navbar-header"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" ui-sref="home"> <img src="images/ia-white.2cc19e45.png" alt="Infoamazônia" width="185" height="40"> </a> </div> <!-- Collect the nav links, forms, and other content for toggling --> <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"> <ul class="nav navbar-nav navbar-right"> <li class="dropdown"> <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Previsões <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a href="" ng-click="ctrl.selectRiver(\'rioacre\')">Rio Acre</a></li> <li><a href="" ng-click="ctrl.selectRiver(\'riomadeira\')">Rio Madeira</a></li> </ul> </li> <li class="dropdown"> <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Séries históricas <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a ui-sref="history({river: \'rioacre\'})">Rio Acre</a></li> <li><a ui-sref="history({river: \'riomadeira\'})">Rio Madeira</a></li> <li><a ui-sref="history({river: \'rioamazonas\'})">Rio Amazonas</a></li> </ul> </li> </ul> </div><!-- /.navbar-collapse --> </div><!-- /.container-fluid --> </nav> <openlayers class="content-fullheight" ol-defaults="ctrl.map.defaults" ol-center="ctrl.map.center"> <ol-marker ol-marker-properties="marker" ng-repeat="marker in ctrl.map.markers"></ol-marker> <ol-layer name="{{layer.name}}" ol-layer-properties="layer" ng-repeat="layer in ctrl.map.layers"></ol-layer> </openlayers> <div class="map-headding text-center"> <h1>Alerta de enchentes</h1> <p class="map-subheadding">Veja as previsões de volume para os rios da região amazônica</p> </div> <div class="map-info"> <div class="map-info-content"> <div class="map-card" ng-show="ctrl.select"> <div class="loading" ng-show="ctrl.loading"> <div class="loading-speeding-wheel"></div> </div> <div ng-hide="ctrl.loading"> <div class="row"> <div class="col-xs-6"> <div style="font-size: 25px">{{ctrl.selectedRiver.name}}</div> <div>{{ctrl.timestamp}}</div> </div> <div class="col-xs-6 text-right"> <div> <span class="glyphicon glyphicon-tint"></span> <span class="alert-measure"></span> </div> <div> <span class="glyphicon glyphicon-time"></span> <span class="alert-time"></span> </div> </div> </div> <div style="margin-top: 25px; font-size: 16px"> <div style="font-size: 22px">{{ctrl.selectedRiver.alert.title}}</div> <div>{{ctrl.selectedRiver.alert.description}}</div> </div> <div ng-show="ctrl.selectedRiver.data.info && ctrl.selectedRiver.data.data.length"> <ae-prediction river="ctrl.selectedRiver.data"></ae-prediction> </div> <div class="text-right"> <a ui-sref="history({river: ctrl.selectedRiver.slug})" class="btn btn-primary">Ver série histórica</a> </div> </div> </div> <!-- <div data-alerta-enchentes-station="13600002" ng-show="ctrl.isSelectedRiver(\'rioacre\')"></div>\n    <div data-alerta-enchentes-station="15400000" ng-show="ctrl.isSelectedRiver(\'riomadeira\')"></div>\n    <script type="text/javascript">\n    (function() {\n      var script = document.createElement(\'script\');\n      script.async = true;\n      script.src   = "http://localhost/alertas-enchentes-widget/alerta-enchentes.js";\n      var entry = document.getElementsByTagName(\'script\')[0];\n      entry.parentNode.insertBefore(script, entry);\n    }());\n    </script> --> </div> </div> <div class="clearfix"></div>'),a.put("views/manaus.html",'<section class="section-header"> <div class="container inner"> <header> <h1>Alerta de enchentes</h1> <p>Veja as previsões de volume para os rios da região amazônica</p> </header> <div class="row"> <div class="col-md-4"> <h2 class="major">Manaus</h2> </div> </div> </div> </section> <section class="section-primary"> <div class="container-fluid"> <h2 class="text-center">Série histórica</h2> <div class="loading" ng-show="ctrl.loading"> <div class="loading-speeding-wheel"></div> </div> <ae-history river="ctrl.river"></ae-history> </div> </section>'),a.put("views/portovelho.html",'<section class="section-header"> <div class="container inner"> <header> <h1>Alerta de enchentes</h1> <p>Veja as previsões de volume para os rios da região amazônica</p> </header> <div class="row"> <div class="col-md-4"> <h2 class="major">Porto Velho</h2> <p>Observando as medições do volume das estações Abunã, Morada Nova e Guajará Mirim, podemos antecipar as enchentes em Porto Velho e região.</p> </div> <div class="col-md-8"> <div data-alerta-enchentes-station="15400000"></div> <script type="text/javascript">(function() {\n              var script = document.createElement(\'script\');\n              script.async = true;\n              script.src   = "http://enchentes.infoamazonia.org:8080/scripts/alerta-enchentes.js";\n              var entry = document.getElementsByTagName(\'script\')[0];\n              entry.parentNode.insertBefore(script, entry);\n          }());</script> </div> </div> </div> </section> <section class="section-primary"> <div class="container-fluid"> <h2 class="text-center">Série histórica</h2> <div class="loading" ng-show="ctrl.loading"> <div class="loading-speeding-wheel"></div> </div> <ae-history river="ctrl.river"></ae-history> </div> </section>'),a.put("views/riobranco.html",'<section class="section-header"> <div class="container inner"> <header> <h1>Alerta de enchentes</h1> <p>Veja as previsões de volume para os rios da região amazônica</p> </header> <div class="row"> <div class="col-md-4"> <h2 class="major">Rio Branco</h2> <p>Observando as medições do volume da estação Xapuri, podemos antecipar as enchentes em Rio Branco e região.</p> </div> <div class="col-md-8"> <div data-alerta-enchentes-station="13600002"></div> <script type="text/javascript">(function() {\n              var script = document.createElement(\'script\');\n              script.async = true;\n              script.src   = "http://enchentes.infoamazonia.org:8080/scripts/alerta-enchentes.js";\n              var entry = document.getElementsByTagName(\'script\')[0];\n              entry.parentNode.insertBefore(script, entry);\n          }());</script> </div> </div> </div> </section> <section class="section-primary"> <div class="container-fluid"> <h2 class="text-center">Série histórica</h2> <div class="loading" ng-show="ctrl.loading"> <div class="loading-speeding-wheel"></div> </div> <ae-history river="ctrl.river"></ae-history> </div> </section>')}]);