"use strict";function routeConfig(a,b){a.state("home",{url:"/",templateUrl:"views/main.html"}).state("riobranco",{url:"/riobranco",templateUrl:"views/riobranco.html",controller:"RioBrancoCtrl",controllerAs:"ctrl"}).state("portovelho",{url:"/portovelho",templateUrl:"views/portovelho.html"}).state("manaus",{url:"/manaus",templateUrl:"views/manaus.html"}),b.otherwise("/")}angular.module("alertasEnchentesApp",["ngAnimate","ngSanitize","ngTouch","ui.router"]).constant("RESTAPI",{url:"http://localhost:5003/api"}).config(routeConfig),routeConfig.$inject=["$stateProvider","$urlRouterProvider"],angular.module("alertasEnchentesApp").controller("MainCtrl",function(){}),function(){function a(){var a=this;a.river="Rio Branco",a.history=[{date:"Jan 2000",price:"1200"},{date:"Fev 2000",price:"1300.46"},{date:"Mar 2000",price:"1400.46"},{date:"Abr 2000",price:"1500.46"},{date:"Mai 2000",price:"1320.46"},{date:"Jun 2000",price:"1394.46"}]}angular.module("alertasEnchentesApp").controller("RioBrancoCtrl",a),a.$inject=[]}(),function(){function a(){return{template:"<svg></svg>",restrict:"E",scope:{history:"="},link:function(a,b){function c(a){return a.date=m(a.date),a.price=+a.price,a}var d=d3,e={top:80,right:10,bottom:100,left:40},f={top:430,right:10,bottom:20,left:40},g=1960-e.left-e.right,h=500-e.top-e.bottom,i=500-f.top-f.bottom,j=300,k=30,l=45,m=d.time.format("%d/%m/%Y").parse,n=d.bisector(function(a){return a.date}).left,o=d.locale({decimal:",",thousands:".",grouping:[3],currency:["R$",""],dateTime:"%d/%m/%Y %H:%M:%S",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]}),p=o.timeFormat("%d de %B  de %Y"),q=d.time.scale().range([0,g]),r=d.time.scale().range([0,g]),s=d.scale.linear().range([h,0]),t=d.scale.linear().range([i,0]),u=d.svg.axis().scale(q).orient("bottom").ticks(d.time.year).innerTickSize(-h).outerTickSize(0).tickPadding(10),v=d.svg.axis().scale(r).orient("bottom").ticks(d.time.year),w=d.svg.axis().scale(s).orient("left"),x=d.svg.brush().x(r),y=d.svg.area().interpolate("monotone").x(function(a){return q(a.date)}).y0(h).y1(function(a){return s(a.price)}),z=d.svg.line().interpolate("monotone").defined(function(a){return a.price}).x(function(a){return q(a.date)}).y(function(a){return s(a.price)}),A=d.svg.area().interpolate("monotone").x(function(a){return r(a.date)}).y0(i).y1(function(a){return t(a.price)}),B=d.select("svg").attr({"class":"timeline-chart",version:"1.1",viewBox:"0 0 "+(g+e.left+e.right)+" "+(h+e.top+e.bottom),width:"100%"});B.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",g).attr("height",h+e.top).attr("transform","translate(0,"+-e.top+")");var C=B.append("g").attr("class","focus").attr("transform","translate("+e.left+","+e.top+")"),D=C.append("path").attr("class","area"),E=C.append("path").attr("class","line");C.append("g").attr("class","dots");var F=C.append("rect").attr("width",g).attr("height",h).style("fill","none").style("pointer-events","all"),G=C.append("g").attr("class","selected-value").style("display","none"),H=G.append("line"),I=G.append("g");I.append("circle").attr("r",8),I.append("circle").attr("r",5);var J=G.append("rect").attr("rx",4).attr("ry",4).attr("width",j).attr("height",k),K=G.append("text").attr("x",9).attr("dy",".35em").attr("text-anchor","middle"),L=B.append("g").attr("class","context").attr("transform","translate("+f.left+","+f.top+")");d.csv("population.csv",c,function(a,b){function c(){q.domain(x.empty()?r.domain():x.extent()),C.select(".area").attr("d",y(b)),C.select(".line").attr("d",z(b)),C.select(".x.axis").call(u),C.selectAll(".dots.max").attr("cx",z.x()).attr("cy",z.y()),C.selectAll(".dots.min").attr("cx",z.x()).attr("cy",z.y())}function e(){G.style("display",null)}function f(){G.style("display","none")}function g(){var a=q.invert(d.mouse(this)[0]),c=n(b,a,1),e=b[c-1],f=b[c],g=a-e.date>f.date-a?f:e;I.attr("transform","translate("+q(g.date)+","+s(g.price)+")"),H.attr({x1:q(g.date),y1:s(O)-l,x2:q(g.date),y2:s(0)}),K.attr("transform","translate("+q(g.date)+","+(s(O)-k/2-l)+")"),K.text(g.price+" em "+p(g.date)),J.attr({x:q(g.date)-j/2,y:s(O)-k-l})}b.sort(function(a,b){return a.date-b.date});var m,o,B=[],M=[],N=[];b.forEach(function(a){o=a.date.getFullYear(),o!==m&&(m=o,B[m]={min:{date:null,price:null},max:{date:null,price:null},data:[]}),B[m].data.push(a)}),B.forEach(function(a,b){var c=-9999,d=9999,e=null,f=null;a.data.forEach(function(a){a.price>c&&(B[b].max.date=a.date,B[b].max.price=a.price,e=a.date,c=a.price),a.price<d&&(B[b].min.date=a.date,B[b].min.price=a.price,d=a.price,f=a.date,d=a.price)}),M.push({date:e,price:c}),N.push({date:f,price:d})});var O=d.max(b.map(function(a){return a.price})),P=d.extent(b.map(function(a){return a.date}));q.domain(P),s.domain([0,O]),r.domain(q.domain()),t.domain(s.domain()),D.attr("d",y(b)),E.attr("d",z(b)),C.selectAll(".dots.max").data(M).enter().append("circle").attr("class","dots max").attr("r",5).attr("cx",function(a){return q(a.date)}).attr("cy",function(a){return s(a.price)}),C.selectAll(".dots.min").data(N).enter().append("circle").attr("class","dots min").attr("r",5).attr("cx",function(a){return q(a.date)}).attr("cy",function(a){return s(a.price)}),C.append("g").attr("class","x axis").attr("transform","translate(0,"+h+")").call(u),C.append("g").attr("class","y axis").call(w),L.append("path").datum(b).attr("class","area2").attr("d",A),L.append("g").attr("class","x axis").attr("transform","translate(0,"+i+")").call(v),L.append("g").attr("class","x brush").call(x).selectAll("rect").attr("y",-6).attr("height",i+7),F.on("mouseover",e).on("mouseout",f).on("mousemove",g),x.extent(P),x.on("brush",c)})}}}angular.module("alertasEnchentesApp").directive("aeHistory",a),a.$inject=[]}(),angular.module("alertasEnchentesApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/main.html",'<section class="section-header"> <div class="container inner section-header-lg"> <header class="main-header text-center"> <h1>Alerta de enchentes</h1> <p class="main-header-subheadding">Veja as previsões de volume para os rios da região amazônica</p> </header> <div class="row"> <div class="col-sm-4"> <a ui-sref="riobranco" class="river-cover river-cover-riobranco"> <span class="river-cover-inner">Rio Branco</span> </a> </div> <div class="col-sm-4"> <a ui-sref="portovelho" class="river-cover river-cover-portovelho"> <span class="river-cover-inner">Porto Velho</span> </a> </div> <div class="col-sm-4"> <a ui-sref="manaus" class="river-cover river-cover-manaus"> <span class="river-cover-inner">Manaus</span> </a> </div> </div> </div> </section> <section class="section-primary"> <div class="container"> <h2 class="text-center">Sobre o projeto</h2> <p>O Sistema de Monitoramento de Seca e Enchentes de Manaus, Rio Branco e Porto Velho é um projeto piloto do InfoAmazonia que tem o objetivo de coletar dados hidrológicos, enviar alertas, produzir e distribuir notícias sobre os impactos das mudanças climáticas nos rios da Amazônia.</p> <p>O projeto responder à necessidade de informação clara, de fácil entendimento das pessoas que sofrem impacto direto das enchentes e secas da falta de políticas públicas que promovam adaptação e mitigação das mudanças do clima.</p> </div> </section>'),a.put("views/manaus.html",'<section class="section-header"> <div class="container inner"> <header> <h1>Alerta de enchentes</h1> <p>Veja as previsões de volume para os rios da região amazônica</p> </header> <div class="row"> <div class="col-md-4"> <h2 class="major">Manaus</h2> </div> </div> </div> </section>'),a.put("views/portovelho.html",'<section class="section-header"> <div class="container inner"> <header> <h1>Alerta de enchentes</h1> <p>Veja as previsões de volume para os rios da região amazônica</p> </header> <div class="row"> <div class="col-md-4"> <h2 class="major">Porto Velho</h2> <p>Observando as medições do volume das estações Abunã, Morada Nova e Guajará Mirim, podemos antecipar as enchentes em Porto Velho e região.</p> </div> <div class="col-md-8"> <div data-alerta-enchentes-station="15400000"></div> <script type="text/javascript">(function() {\n              var script = document.createElement(\'script\');\n              script.async = true;\n              script.src   = "http://alertas-enchentes-api.herokuapp.com/scripts/alerta-enchentes.js";\n              var entry = document.getElementsByTagName(\'script\')[0];\n              entry.parentNode.insertBefore(script, entry);\n          }());</script> </div> </div> </div> </section>'),a.put("views/riobranco.html",'<section class="section-header"> <div class="container inner"> <header> <h1>Alerta de enchentes</h1> <p>Veja as previsões de volume para os rios da região amazônica</p> </header> <div class="row"> <div class="col-md-4"> <h2 class="major">Rio Branco</h2> <p>Observando as medições do volume da estação Xapuri, podemos antecipar as enchentes em Rio Branco e região.</p> </div> <div class="col-md-8"> <div data-alerta-enchentes-station="13600002"></div> <script type="text/javascript">(function() {\n              var script = document.createElement(\'script\');\n              script.async = true;\n              script.src   = "http://alertas-enchentes-api.herokuapp.com/scripts/alerta-enchentes.js";\n              var entry = document.getElementsByTagName(\'script\')[0];\n              entry.parentNode.insertBefore(script, entry);\n          }());</script> </div> </div> </div> </section> <section class="section-primary"> <div class="container-fluid"> <h2 class="text-center">Série histórica</h2> <ae-history history="ctrl.history"></ae-history> </div> </section>')}]);