package br.edu.ufcg.analytics.infoamazonia;

import java.io.File;
import java.io.FileNotFoundException;
import java.time.format.DateTimeFormatter;
import java.util.Arrays;
import java.util.Scanner;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.context.event.ApplicationReadyEvent;
import org.springframework.context.ApplicationListener;
import org.springframework.stereotype.Component;

import br.edu.ufcg.analytics.infoamazonia.model.Station;
import br.edu.ufcg.analytics.infoamazonia.model.StationRepository;
import br.edu.ufcg.analytics.infoamazonia.model.Summary;
import br.edu.ufcg.analytics.infoamazonia.model.SummaryRepository;

@Component
public class StationLoader implements ApplicationListener<ApplicationReadyEvent>{
	
	protected DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss");

	@Autowired
	private StationRepository repository;

	@Autowired
	private SummaryRepository summaryRepository;

	@Override
	public void onApplicationEvent(ApplicationReadyEvent arg0) {
		
		System.out.println("StationLoader: loading stations");
		
//		if(repository.count() == 0){
			Station xapuri = new Station(13551000, "XAPURI - PCD", "RIO ACRE", "XAPURI", -1, -1, "01/12/201400:00:00", false, 103868300L, "dDw0MDI2NjM1MTE7dDw7bDxpPDE+Oz47bDx0PDtsPGk8NT47aTwxMT47aTwxMj47aTwxMz47aTwxND47aTwxNj47aTwxOD47aTwyMT47aTwyOT47aTw0OD47aTw0OT47aTw1Mj47aTw1ND47PjtsPHQ8cDxwPGw8VGV4dDtGb3JlQ29sb3I7XyFTQjs+O2w8IHxTw6lyaWUgaGlzdMOzcmljYSB8OzI8MCwgMCwgMTIwPjtpPDQ+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O18hU0I7V2lkdGg7PjtsPHwgUGVzcXVpc2FyIERhZG9zIHw7aTwyNTY+OzE8MTE1cHg+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O0ZvcmVDb2xvcjtfIVNCO1dpZHRoO0JhY2tDb2xvcjs+O2w8fCBFeHBvcnRhciBEYWRvcyB8OzI8V2hpdGU+O2k8MjY4PjsxPDEwNXB4PjsyPDAsIDAsIDEyMD47Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7XyFTQjtXaWR0aDs+O2w8XGU7aTwyNTY+OzE8MHB4Pjs+Pjs+Ozs+O3Q8cDxwPGw8VGV4dDtfIVNCO1dpZHRoOz47bDxcZTtpPDI1Nj47MTwwcHg+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O18hU0I7V2lkdGg7PjtsPFxlO2k8MjU2PjsxPDBweD47Pj47Pjs7Pjt0PHQ8O3Q8aTwxPjtAPDEzNTUxMDAwIFhBUFVSSSAtIFBDRDs+O0A8MTAzODY4MzAwOz4+Oz47Oz47dDxwPHA8bDxUZXh0O0ZvcmVDb2xvcjtfIVNCOz47bDxJbmZvcm1lIGEgImVzdGHDp8OjbyIgLjsyPFJlZD47aTw0Pjs+Pjs+Ozs+O3Q8dDw7dDxpPDI+O0A8Q2h1dmE6IDAxLzEyLzIwMTQgLSAyOC8wOC8yMDE2O07DrXZlbDogMDEvMTIvMjAxNCAtIDI4LzA4LzIwMTY7PjtAPDE7Mjs+PjtsPGk8MT47Pj47Oz47dDx0PDt0PGk8Nj47QDxcPHRvZG9zXD47QU5BL0lOUEU7QU5BL1NJVkFNO1NldG9yIEVsw6l0cmljbztDb3RhT25saW5lO1Byb2pldG9zX0VzcGVjaWFpczs+O0A8MDsxOzI7Mzs0OzU7Pj47bDxpPDU+Oz4+Ozs+O3Q8dDw7dDxpPDEwPjtAPFw8dG9kb3NcPjsxIFJpbyBBbWF6b25hczsyIFJpbyBUb2NhbnRpbnM7MyBBdGzDom50aWNvLCBUcmVjaG8gTm9ydGUvTm9yZGVzdGU7NCBSaW8gU8OjbyBGcmFuY2lzY287NSBBdGzDom50aWNvLCBUcmVjaG8gTGVzdGU7NiBSaW8gUGFyYW7DocKgOzcgUmlvIFVydWd1YWk7OCBBdGzDom50aWNvLCBUcmVjaG8gU3VkZXN0ZTs5IE91dHJhczs+O0A8MDsxOzI7Mzs0OzU7Njs3Ozg7OTs+PjtsPGk8MT47Pj47Oz47dDx0PDt0PGk8MTE+O0A8XDx0b2Rvc1w+OzEwIFJJTyBTT0xJTU9FUywgSkFWQVJJLElUQUNVQUk7MTEgUklPIFNPTElNT0VTLElDQSxKQU5ESUFUVUJBLC4uOzEyIFJJTyBTT0xJTU9FUyxKVVJVQSxKQVBVUkEsLi4uLjsxMyBSSU8gU09MSU1PRVMsUFVSVVMsQ09BUkksLi47MTQgUklPIFNPTElNT0VTLE5FR1JPLEJSQU5DTywuLi4uOzE1IFJJTyBBTUFaT05BUyxNQURFSVJBLEdVQVBPUkUsLjsxNiBSSU8gQU1BWk9OQVMsVFJPTUJFVEFTLE9VVFJPUzsxNyBSSU8gQU1BWk9OQVMsVEFQQUpPUyxKVVJVRU5BLi47MTggUklPIEFNQVpPTkFTLFhJTkdVLElSSVJJLFBBUlU7MTkgUklPIEFNQVpPTkFTLEpBUkksUEFSQSxPVVRST1M7PjtAPDA7MTA7MTE7MTI7MTM7MTQ7MTU7MTY7MTc7MTg7MTk7Pj47bDxpPDQ+Oz4+Ozs+O3Q8cDxwPGw8VGV4dDs+O2w8MTM1NTEwMDA7Pj47Pjs7Pjs+Pjs+PjtsPGxzdEVzdGFjYW87YnRBdHVhbGl6YXI7bHN0RGlzcG9uaXZlbDtsc3RPcmlnZW07bHN0QmFjaWE7bHN0U3ViQmFjaWE7Pj5PU8MpuI6MRVrTHYBL6h61B6gd2Q==", 1, 13);
			Station riobranco = new Station(13600002, "RIO BRANCO", "RIO ACRE", "RIO BRANCO", 1350, 1400, "01/08/200500:00:00", 
					true, 95867480L, "dDw0MDI2NjM1MTE7dDw7bDxpPDE+Oz47bDx0PDtsPGk8NT47aTwxMT47aTwxMj47aTwxMz47aTwxND47aTwxNj47aTwxOD47aTwyMT47aTwyOT47aTw0OD47aTw0OT47aTw1Mj47aTw1ND47PjtsPHQ8cDxwPGw8VGV4dDtGb3JlQ29sb3I7XyFTQjs+O2w8IHxTw6lyaWUgaGlzdMOzcmljYSB8OzI8MCwgMCwgMTIwPjtpPDQ+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O18hU0I7V2lkdGg7PjtsPHwgUGVzcXVpc2FyIERhZG9zIHw7aTwyNTY+OzE8MTE1cHg+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O0ZvcmVDb2xvcjtfIVNCO1dpZHRoO0JhY2tDb2xvcjs+O2w8fCBFeHBvcnRhciBEYWRvcyB8OzI8V2hpdGU+O2k8MjY4PjsxPDEwNXB4PjsyPDAsIDAsIDEyMD47Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7XyFTQjtXaWR0aDs+O2w8XGU7aTwyNTY+OzE8MHB4Pjs+Pjs+Ozs+O3Q8cDxwPGw8VGV4dDtfIVNCO1dpZHRoOz47bDxcZTtpPDI1Nj47MTwwcHg+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O18hU0I7V2lkdGg7PjtsPFxlO2k8MjU2PjsxPDBweD47Pj47Pjs7Pjt0PHQ8O3Q8aTwyPjtAPDEzNjAwMDAyIFJJTyBCUkFOQ087MTM2MDAwMDIgUklPIEJSQU5DTzs+O0A8OTU5Njc0ODA7OTU4Njc0ODA7Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7Rm9yZUNvbG9yO18hU0I7PjtsPFxlOzI8UmVkPjtpPDQ+Oz4+Oz47Oz47dDx0PDt0PGk8Mz47QDxDaHV2YTogMDEvMTIvMjAxNCAtIDAzLzExLzIwMTY7TsOtdmVsOiAwMS8xMi8yMDE0IC0gMDMvMTEvMjAxNjtWYXrDo286IDAxLzEyLzIwMTQgLSAwMy8xMS8yMDE2Oz47QDwxOzI7Mzs+PjtsPGk8MT47Pj47Oz47dDx0PDt0PGk8Nj47QDxcPHRvZG9zXD47QU5BL0lOUEU7QU5BL1NJVkFNO1NldG9yIEVsw6l0cmljbztDb3RhT25saW5lO1Byb2pldG9zX0VzcGVjaWFpczs+O0A8MDsxOzI7Mzs0OzU7Pj47bDxpPDU+Oz4+Ozs+O3Q8dDw7dDxpPDEwPjtAPFw8dG9kb3NcPjsxIFJpbyBBbWF6b25hczsyIFJpbyBUb2NhbnRpbnM7MyBBdGzDom50aWNvLCBUcmVjaG8gTm9ydGUvTm9yZGVzdGU7NCBSaW8gU8OjbyBGcmFuY2lzY287NSBBdGzDom50aWNvLCBUcmVjaG8gTGVzdGU7NiBSaW8gUGFyYW7DocKgOzcgUmlvIFVydWd1YWk7OCBBdGzDom50aWNvLCBUcmVjaG8gU3VkZXN0ZTs5IE91dHJhczs+O0A8MDsxOzI7Mzs0OzU7Njs3Ozg7OTs+PjtsPGk8MT47Pj47Oz47dDx0PDt0PGk8MTE+O0A8XDx0b2Rvc1w+OzEwIFJJTyBTT0xJTU9FUywgSkFWQVJJLElUQUNVQUk7MTEgUklPIFNPTElNT0VTLElDQSxKQU5ESUFUVUJBLC4uOzEyIFJJTyBTT0xJTU9FUyxKVVJVQSxKQVBVUkEsLi4uLjsxMyBSSU8gU09MSU1PRVMsUFVSVVMsQ09BUkksLi47MTQgUklPIFNPTElNT0VTLE5FR1JPLEJSQU5DTywuLi4uOzE1IFJJTyBBTUFaT05BUyxNQURFSVJBLEdVQVBPUkUsLjsxNiBSSU8gQU1BWk9OQVMsVFJPTUJFVEFTLE9VVFJPUzsxNyBSSU8gQU1BWk9OQVMsVEFQQUpPUyxKVVJVRU5BLi47MTggUklPIEFNQVpPTkFTLFhJTkdVLElSSVJJLFBBUlU7MTkgUklPIEFNQVpPTkFTLEpBUkksUEFSQSxPVVRST1M7PjtAPDA7MTA7MTE7MTI7MTM7MTQ7MTU7MTY7MTc7MTg7MTk7Pj47bDxpPDQ+Oz4+Ozs+O3Q8cDxwPGw8VGV4dDs+O2w8MTM2MDAwMDI7Pj47Pjs7Pjs+Pjs+PjtsPGxzdEVzdGFjYW87YnRBdHVhbGl6YXI7bHN0RGlzcG9uaXZlbDtsc3RPcmlnZW07bHN0QmFjaWE7bHN0U3ViQmFjaWE7Pj6hfOMdNBJIW8nXsAHG2o/aVK2emw==", 1, 13);
			Station abuna = new Station(15320002, "ABUNÃ", "RIO MADEIRA", "PORTO VELHO", -1, -1, "29/10/201400:00:00", false, 94265212L, "dDw0MDI2NjM1MTE7dDw7bDxpPDE+Oz47bDx0PDtsPGk8NT47aTwxMT47aTwxMj47aTwxMz47aTwxND47aTwxNj47aTwxOD47aTwyMT47aTwyOT47aTw0OD47aTw0OT47aTw1Mj47aTw1ND47PjtsPHQ8cDxwPGw8VGV4dDtGb3JlQ29sb3I7XyFTQjs+O2w8IHxTw6lyaWUgaGlzdMOzcmljYSB8OzI8MCwgMCwgMTIwPjtpPDQ+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O18hU0I7V2lkdGg7PjtsPHwgUGVzcXVpc2FyIERhZG9zIHw7aTwyNTY+OzE8MTE1cHg+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O0ZvcmVDb2xvcjtfIVNCO1dpZHRoO0JhY2tDb2xvcjs+O2w8fCBFeHBvcnRhciBEYWRvcyB8OzI8V2hpdGU+O2k8MjY4PjsxPDEwNXB4PjsyPDAsIDAsIDEyMD47Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7XyFTQjtXaWR0aDs+O2w8XGU7aTwyNTY+OzE8MHB4Pjs+Pjs+Ozs+O3Q8cDxwPGw8VGV4dDtfIVNCO1dpZHRoOz47bDxcZTtpPDI1Nj47MTwwcHg+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O18hU0I7V2lkdGg7PjtsPFxlO2k8MjU2PjsxPDBweD47Pj47Pjs7Pjt0PHQ8O3Q8aTwxPjtAPDE1MzIwMDAyIEFCVU7Dgzs+O0A8OTQyNjUyMTI7Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7Rm9yZUNvbG9yO18hU0I7PjtsPFxlOzI8UmVkPjtpPDQ+Oz4+Oz47Oz47dDx0PDt0PGk8Mz47QDxDaHV2YTogMjkvMTAvMjAxNCAtIDMwLzA4LzIwMTY7TsOtdmVsOiAyOS8xMC8yMDE0IC0gMzAvMDgvMjAxNjtWYXrDo286IDI2LzAxLzIwMTUgLSAzMC8wOC8yMDE2Oz47QDwxOzI7Mzs+PjtsPGk8MT47Pj47Oz47dDx0PDt0PGk8Nj47QDxcPHRvZG9zXD47QU5BL0lOUEU7QU5BL1NJVkFNO1NldG9yIEVsw6l0cmljbztDb3RhT25saW5lO1Byb2pldG9zX0VzcGVjaWFpczs+O0A8MDsxOzI7Mzs0OzU7Pj47bDxpPDU+Oz4+Ozs+O3Q8dDw7dDxpPDEwPjtAPFw8dG9kb3NcPjsxIFJpbyBBbWF6b25hczsyIFJpbyBUb2NhbnRpbnM7MyBBdGzDom50aWNvLCBUcmVjaG8gTm9ydGUvTm9yZGVzdGU7NCBSaW8gU8OjbyBGcmFuY2lzY287NSBBdGzDom50aWNvLCBUcmVjaG8gTGVzdGU7NiBSaW8gUGFyYW7DocKgOzcgUmlvIFVydWd1YWk7OCBBdGzDom50aWNvLCBUcmVjaG8gU3VkZXN0ZTs5IE91dHJhczs+O0A8MDsxOzI7Mzs0OzU7Njs3Ozg7OTs+PjtsPGk8MT47Pj47Oz47dDx0PDt0PGk8MTE+O0A8XDx0b2Rvc1w+OzEwIFJJTyBTT0xJTU9FUywgSkFWQVJJLElUQUNVQUk7MTEgUklPIFNPTElNT0VTLElDQSxKQU5ESUFUVUJBLC4uOzEyIFJJTyBTT0xJTU9FUyxKVVJVQSxKQVBVUkEsLi4uLjsxMyBSSU8gU09MSU1PRVMsUFVSVVMsQ09BUkksLi47MTQgUklPIFNPTElNT0VTLE5FR1JPLEJSQU5DTywuLi4uOzE1IFJJTyBBTUFaT05BUyxNQURFSVJBLEdVQVBPUkUsLjsxNiBSSU8gQU1BWk9OQVMsVFJPTUJFVEFTLE9VVFJPUzsxNyBSSU8gQU1BWk9OQVMsVEFQQUpPUyxKVVJVRU5BLi47MTggUklPIEFNQVpPTkFTLFhJTkdVLElSSVJJLFBBUlU7MTkgUklPIEFNQVpPTkFTLEpBUkksUEFSQSxPVVRST1M7PjtAPDA7MTA7MTE7MTI7MTM7MTQ7MTU7MTY7MTc7MTg7MTk7Pj47bDxpPDY+Oz4+Ozs+O3Q8cDxwPGw8VGV4dDs+O2w8MTUzMjAwMDI7Pj47Pjs7Pjs+Pjs+PjtsPGxzdEVzdGFjYW87YnRBdHVhbGl6YXI7bHN0RGlzcG9uaXZlbDtsc3RPcmlnZW07bHN0QmFjaWE7bHN0U3ViQmFjaWE7Pj7nSkiytjQmd3UDcp0JTRVBUYx2QQ==", 1, 15);
			Station morada = new Station(15326000, "MORADA NOVA - JUSANTE",  "RIO ABUNÃ", "PORTO VELHO", -1, -1, "29/06/200500:00:00", false, 94765320L, "dDw0MDI2NjM1MTE7dDw7bDxpPDE+Oz47bDx0PDtsPGk8NT47aTwxMT47aTwxMj47aTwxMz47aTwxND47aTwxNj47aTwxOD47aTwyMT47aTwyOT47aTw0OD47aTw0OT47aTw1Mj47aTw1ND47PjtsPHQ8cDxwPGw8VGV4dDtGb3JlQ29sb3I7XyFTQjs+O2w8IHxTw6lyaWUgaGlzdMOzcmljYSB8OzI8MCwgMCwgMTIwPjtpPDQ+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O18hU0I7V2lkdGg7PjtsPHwgUGVzcXVpc2FyIERhZG9zIHw7aTwyNTY+OzE8MTE1cHg+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O0ZvcmVDb2xvcjtfIVNCO1dpZHRoO0JhY2tDb2xvcjs+O2w8fCBFeHBvcnRhciBEYWRvcyB8OzI8V2hpdGU+O2k8MjY4PjsxPDEwNXB4PjsyPDAsIDAsIDEyMD47Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7XyFTQjtXaWR0aDs+O2w8XGU7aTwyNTY+OzE8MHB4Pjs+Pjs+Ozs+O3Q8cDxwPGw8VGV4dDtfIVNCO1dpZHRoOz47bDxcZTtpPDI1Nj47MTwwcHg+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O18hU0I7V2lkdGg7PjtsPFxlO2k8MjU2PjsxPDBweD47Pj47Pjs7Pjt0PHQ8O3Q8aTwxPjtAPDE1MzI2MDAwIE1PUkFEQSBOT1ZBIC0gSlVTQU5URTs+O0A8OTQ3NjUzMjA7Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7Rm9yZUNvbG9yO18hU0I7PjtsPFxlOzI8UmVkPjtpPDQ+Oz4+Oz47Oz47dDx0PDt0PGk8Mz47QDxDaHV2YTogMjkvMTAvMjAxNCAtIDMwLzA4LzIwMTY7TsOtdmVsOiAyOS8xMC8yMDE0IC0gMzAvMDgvMjAxNjtWYXrDo286IDI2LzAxLzIwMTUgLSAzMC8wOC8yMDE2Oz47QDwxOzI7Mzs+PjtsPGk8MT47Pj47Oz47dDx0PDt0PGk8Nj47QDxcPHRvZG9zXD47QU5BL0lOUEU7QU5BL1NJVkFNO1NldG9yIEVsw6l0cmljbztDb3RhT25saW5lO1Byb2pldG9zX0VzcGVjaWFpczs+O0A8MDsxOzI7Mzs0OzU7Pj47bDxpPDU+Oz4+Ozs+O3Q8dDw7dDxpPDEwPjtAPFw8dG9kb3NcPjsxIFJpbyBBbWF6b25hczsyIFJpbyBUb2NhbnRpbnM7MyBBdGzDom50aWNvLCBUcmVjaG8gTm9ydGUvTm9yZGVzdGU7NCBSaW8gU8OjbyBGcmFuY2lzY287NSBBdGzDom50aWNvLCBUcmVjaG8gTGVzdGU7NiBSaW8gUGFyYW7DocKgOzcgUmlvIFVydWd1YWk7OCBBdGzDom50aWNvLCBUcmVjaG8gU3VkZXN0ZTs5IE91dHJhczs+O0A8MDsxOzI7Mzs0OzU7Njs3Ozg7OTs+PjtsPGk8MT47Pj47Oz47dDx0PDt0PGk8MTE+O0A8XDx0b2Rvc1w+OzEwIFJJTyBTT0xJTU9FUywgSkFWQVJJLElUQUNVQUk7MTEgUklPIFNPTElNT0VTLElDQSxKQU5ESUFUVUJBLC4uOzEyIFJJTyBTT0xJTU9FUyxKVVJVQSxKQVBVUkEsLi4uLjsxMyBSSU8gU09MSU1PRVMsUFVSVVMsQ09BUkksLi47MTQgUklPIFNPTElNT0VTLE5FR1JPLEJSQU5DTywuLi4uOzE1IFJJTyBBTUFaT05BUyxNQURFSVJBLEdVQVBPUkUsLjsxNiBSSU8gQU1BWk9OQVMsVFJPTUJFVEFTLE9VVFJPUzsxNyBSSU8gQU1BWk9OQVMsVEFQQUpPUyxKVVJVRU5BLi47MTggUklPIEFNQVpPTkFTLFhJTkdVLElSSVJJLFBBUlU7MTkgUklPIEFNQVpPTkFTLEpBUkksUEFSQSxPVVRST1M7PjtAPDA7MTA7MTE7MTI7MTM7MTQ7MTU7MTY7MTc7MTg7MTk7Pj47bDxpPDY+Oz4+Ozs+O3Q8cDxwPGw8VGV4dDs+O2w8MTUzMjYwMDA7Pj47Pjs7Pjs+Pjs+PjtsPGxzdEVzdGFjYW87YnRBdHVhbGl6YXI7bHN0RGlzcG9uaXZlbDtsc3RPcmlnZW07bHN0QmFjaWE7bHN0U3ViQmFjaWE7Pj7QYWuz90SGm5zfOuqFB6MyrkjVPA==", 1, 15);
			Station guajara = new Station(15250000, "GUAJARÁ - MIRIM", "RIO MAMORÉ", "GUAJARÁ-MIRIM", -1, -1, "26/10/200500:00:00", false, 104865210L, "dDw0MDI2NjM1MTE7dDw7bDxpPDE+Oz47bDx0PDtsPGk8NT47aTwxMT47aTwxMj47aTwxMz47aTwxND47aTwxNj47aTwxOD47aTwyMT47aTwyOT47aTw0OD47aTw0OT47aTw1Mj47aTw1ND47PjtsPHQ8cDxwPGw8VGV4dDtGb3JlQ29sb3I7XyFTQjs+O2w8IHxTw6lyaWUgaGlzdMOzcmljYSB8OzI8MCwgMCwgMTIwPjtpPDQ+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O18hU0I7V2lkdGg7PjtsPHwgUGVzcXVpc2FyIERhZG9zIHw7aTwyNTY+OzE8MTE1cHg+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O0ZvcmVDb2xvcjtfIVNCO1dpZHRoO0JhY2tDb2xvcjs+O2w8fCBFeHBvcnRhciBEYWRvcyB8OzI8V2hpdGU+O2k8MjY4PjsxPDEwNXB4PjsyPDAsIDAsIDEyMD47Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7XyFTQjtXaWR0aDs+O2w8XGU7aTwyNTY+OzE8MHB4Pjs+Pjs+Ozs+O3Q8cDxwPGw8VGV4dDtfIVNCO1dpZHRoOz47bDxcZTtpPDI1Nj47MTwwcHg+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O18hU0I7V2lkdGg7PjtsPFxlO2k8MjU2PjsxPDBweD47Pj47Pjs7Pjt0PHQ8O3Q8aTwxPjtAPDE1MjUwMDAwIEdVQUpBUsOBLU1JUklNOz47QDwxMDQ4NjUyMTA7Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7Rm9yZUNvbG9yO18hU0I7PjtsPEluZm9ybWUgYSAiZXN0YcOnw6NvIiAuOzI8UmVkPjtpPDQ+Oz4+Oz47Oz47dDx0PDt0PGk8Mz47QDxDaHV2YTogMjkvMTAvMjAxNCAtIDMwLzA4LzIwMTY7TsOtdmVsOiAyOS8xMC8yMDE0IC0gMzAvMDgvMjAxNjtWYXrDo286IDI2LzAxLzIwMTUgLSAzMC8wOC8yMDE2Oz47QDwxOzI7Mzs+PjtsPGk8MT47Pj47Oz47dDx0PDt0PGk8Nj47QDxcPHRvZG9zXD47QU5BL0lOUEU7QU5BL1NJVkFNO1NldG9yIEVsw6l0cmljbztDb3RhT25saW5lO1Byb2pldG9zX0VzcGVjaWFpczs+O0A8MDsxOzI7Mzs0OzU7Pj47bDxpPDU+Oz4+Ozs+O3Q8dDw7dDxpPDEwPjtAPFw8dG9kb3NcPjsxIFJpbyBBbWF6b25hczsyIFJpbyBUb2NhbnRpbnM7MyBBdGzDom50aWNvLCBUcmVjaG8gTm9ydGUvTm9yZGVzdGU7NCBSaW8gU8OjbyBGcmFuY2lzY287NSBBdGzDom50aWNvLCBUcmVjaG8gTGVzdGU7NiBSaW8gUGFyYW7DocKgOzcgUmlvIFVydWd1YWk7OCBBdGzDom50aWNvLCBUcmVjaG8gU3VkZXN0ZTs5IE91dHJhczs+O0A8MDsxOzI7Mzs0OzU7Njs3Ozg7OTs+PjtsPGk8MT47Pj47Oz47dDx0PDt0PGk8MTE+O0A8XDx0b2Rvc1w+OzEwIFJJTyBTT0xJTU9FUywgSkFWQVJJLElUQUNVQUk7MTEgUklPIFNPTElNT0VTLElDQSxKQU5ESUFUVUJBLC4uOzEyIFJJTyBTT0xJTU9FUyxKVVJVQSxKQVBVUkEsLi4uLjsxMyBSSU8gU09MSU1PRVMsUFVSVVMsQ09BUkksLi47MTQgUklPIFNPTElNT0VTLE5FR1JPLEJSQU5DTywuLi4uOzE1IFJJTyBBTUFaT05BUyxNQURFSVJBLEdVQVBPUkUsLjsxNiBSSU8gQU1BWk9OQVMsVFJPTUJFVEFTLE9VVFJPUzsxNyBSSU8gQU1BWk9OQVMsVEFQQUpPUyxKVVJVRU5BLi47MTggUklPIEFNQVpPTkFTLFhJTkdVLElSSVJJLFBBUlU7MTkgUklPIEFNQVpPTkFTLEpBUkksUEFSQSxPVVRST1M7PjtAPDA7MTA7MTE7MTI7MTM7MTQ7MTU7MTY7MTc7MTg7MTk7Pj47bDxpPDY+Oz4+Ozs+O3Q8cDxwPGw8VGV4dDs+O2w8MTUyNTAwMDA7Pj47Pjs7Pjs+Pjs+PjtsPGxzdEVzdGFjYW87YnRBdHVhbGl6YXI7bHN0RGlzcG9uaXZlbDtsc3RPcmlnZW07bHN0QmFjaWE7bHN0U3ViQmFjaWE7Pj6ys62+LPYdvDsJh0dNtALxgrDdYQ==", 1, 15);
			Station portovelho = new Station(15400000, "PORTO VELHO", "RIO MADEIRA", "PORTO VELHO", 1500, 1700, "03/09/200500:00:00", true, 84863570L, "dDw0MDI2NjM1MTE7dDw7bDxpPDE+Oz47bDx0PDtsPGk8NT47aTwxMT47aTwxMj47aTwxMz47aTwxND47aTwxNj47aTwxOD47aTwyMT47aTwyOT47aTw0OD47aTw0OT47aTw1Mj47aTw1ND47PjtsPHQ8cDxwPGw8VGV4dDtGb3JlQ29sb3I7XyFTQjs+O2w8IHxTw6lyaWUgaGlzdMOzcmljYSB8OzI8MCwgMCwgMTIwPjtpPDQ+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O18hU0I7V2lkdGg7PjtsPHwgUGVzcXVpc2FyIERhZG9zIHw7aTwyNTY+OzE8MTE1cHg+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O0ZvcmVDb2xvcjtfIVNCO1dpZHRoO0JhY2tDb2xvcjs+O2w8fCBFeHBvcnRhciBEYWRvcyB8OzI8V2hpdGU+O2k8MjY4PjsxPDEwNXB4PjsyPDAsIDAsIDEyMD47Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7XyFTQjtXaWR0aDs+O2w8XGU7aTwyNTY+OzE8MHB4Pjs+Pjs+Ozs+O3Q8cDxwPGw8VGV4dDtfIVNCO1dpZHRoOz47bDxcZTtpPDI1Nj47MTwwcHg+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O18hU0I7V2lkdGg7PjtsPFxlO2k8MjU2PjsxPDBweD47Pj47Pjs7Pjt0PHQ8O3Q8aTwxPjtAPDE1NDAwMDAwIFBPUlRPIFZFTEhPOz47QDw4NDg2MzU3MDs+Pjs+Ozs+O3Q8cDxwPGw8VGV4dDtGb3JlQ29sb3I7XyFTQjs+O2w8SW5mb3JtZSBhICJlc3Rhw6fDo28iIC47MjxSZWQ+O2k8ND47Pj47Pjs7Pjt0PHQ8O3Q8aTwzPjtAPENodXZhOiAyOS8xMC8yMDE0IC0gMzAvMDgvMjAxNjtOw612ZWw6IDI5LzEwLzIwMTQgLSAzMC8wOC8yMDE2O1ZhesOjbzogMjYvMDEvMjAxNSAtIDMwLzA4LzIwMTY7PjtAPDE7MjszOz4+O2w8aTwxPjs+Pjs7Pjt0PHQ8O3Q8aTw2PjtAPFw8dG9kb3NcPjtBTkEvSU5QRTtBTkEvU0lWQU07U2V0b3IgRWzDqXRyaWNvO0NvdGFPbmxpbmU7UHJvamV0b3NfRXNwZWNpYWlzOz47QDwwOzE7MjszOzQ7NTs+PjtsPGk8NT47Pj47Oz47dDx0PDt0PGk8MTA+O0A8XDx0b2Rvc1w+OzEgUmlvIEFtYXpvbmFzOzIgUmlvIFRvY2FudGluczszIEF0bMOibnRpY28sIFRyZWNobyBOb3J0ZS9Ob3JkZXN0ZTs0IFJpbyBTw6NvIEZyYW5jaXNjbzs1IEF0bMOibnRpY28sIFRyZWNobyBMZXN0ZTs2IFJpbyBQYXJhbsOhwqA7NyBSaW8gVXJ1Z3VhaTs4IEF0bMOibnRpY28sIFRyZWNobyBTdWRlc3RlOzkgT3V0cmFzOz47QDwwOzE7MjszOzQ7NTs2Ozc7ODs5Oz4+O2w8aTwxPjs+Pjs7Pjt0PHQ8O3Q8aTwxMT47QDxcPHRvZG9zXD47MTAgUklPIFNPTElNT0VTLCBKQVZBUkksSVRBQ1VBSTsxMSBSSU8gU09MSU1PRVMsSUNBLEpBTkRJQVRVQkEsLi47MTIgUklPIFNPTElNT0VTLEpVUlVBLEpBUFVSQSwuLi4uOzEzIFJJTyBTT0xJTU9FUyxQVVJVUyxDT0FSSSwuLjsxNCBSSU8gU09MSU1PRVMsTkVHUk8sQlJBTkNPLC4uLi47MTUgUklPIEFNQVpPTkFTLE1BREVJUkEsR1VBUE9SRSwuOzE2IFJJTyBBTUFaT05BUyxUUk9NQkVUQVMsT1VUUk9TOzE3IFJJTyBBTUFaT05BUyxUQVBBSk9TLEpVUlVFTkEuLjsxOCBSSU8gQU1BWk9OQVMsWElOR1UsSVJJUkksUEFSVTsxOSBSSU8gQU1BWk9OQVMsSkFSSSxQQVJBLE9VVFJPUzs+O0A8MDsxMDsxMTsxMjsxMzsxNDsxNTsxNjsxNzsxODsxOTs+PjtsPGk8Nj47Pj47Oz47dDxwPHA8bDxUZXh0Oz47bDwxNTQwMDAwMDs+Pjs+Ozs+Oz4+Oz4+O2w8bHN0RXN0YWNhbztidEF0dWFsaXphcjtsc3REaXNwb25pdmVsO2xzdE9yaWdlbTtsc3RCYWNpYTtsc3RTdWJCYWNpYTs+PhMI6KzKstHjd3G4evnPNyD8djRI", 1, 15);
			Station manaus = new Station(14990000, "MANAUS", "RIO NEGRO", "MANAUS", -1, -1, "30/06/200500:00:00", false, 30659600L, "dDw0MDI2NjM1MTE7dDw7bDxpPDE+Oz47bDx0PDtsPGk8NT47aTwxMT47aTwxMj47aTwxMz47aTwxND47aTwxNj47aTwxOD47aTwyMT47aTwyOT47aTw0OD47aTw0OT47aTw1Mj47aTw1ND47PjtsPHQ8cDxwPGw8VGV4dDtGb3JlQ29sb3I7XyFTQjs+O2w8IHxTw6lyaWUgaGlzdMOzcmljYSB8OzI8MCwgMCwgMTIwPjtpPDQ+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O18hU0I7V2lkdGg7PjtsPHwgUGVzcXVpc2FyIERhZG9zIHw7aTwyNTY+OzE8MTE1cHg+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O0ZvcmVDb2xvcjtfIVNCO1dpZHRoO0JhY2tDb2xvcjs+O2w8fCBFeHBvcnRhciBEYWRvcyB8OzI8V2hpdGU+O2k8MjY4PjsxPDEwNXB4PjsyPDAsIDAsIDEyMD47Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7XyFTQjtXaWR0aDs+O2w8XGU7aTwyNTY+OzE8MHB4Pjs+Pjs+Ozs+O3Q8cDxwPGw8VGV4dDtfIVNCO1dpZHRoOz47bDxcZTtpPDI1Nj47MTwwcHg+Oz4+Oz47Oz47dDxwPHA8bDxUZXh0O18hU0I7V2lkdGg7PjtsPFxlO2k8MjU2PjsxPDBweD47Pj47Pjs7Pjt0PHQ8O3Q8aTwxPjtAPDE0OTkwMDAwIE1BTkFVUzs+O0A8MzA2NTk2MDA7Pj47Pjs7Pjt0PHA8cDxsPFRleHQ7Rm9yZUNvbG9yO18hU0I7PjtsPFxlOzI8UmVkPjtpPDQ+Oz4+Oz47Oz47dDx0PDt0PGk8Mj47QDxDaHV2YTogMjkvMDYvMjAwNSAtIDMwLzA5LzIwMTY7TsOtdmVsOiAzMC8wNi8yMDA1IC0gMzAvMDkvMjAxNjs+O0A8MTsyOz4+O2w8aTwxPjs+Pjs7Pjt0PHQ8O3Q8aTw2PjtAPFw8dG9kb3NcPjtBTkEvSU5QRTtBTkEvU0lWQU07U2V0b3IgRWzDqXRyaWNvO0NvdGFPbmxpbmU7UHJvamV0b3NfRXNwZWNpYWlzOz47QDwwOzE7MjszOzQ7NTs+PjtsPGk8NT47Pj47Oz47dDx0PDt0PGk8MTA+O0A8XDx0b2Rvc1w+OzEgUmlvIEFtYXpvbmFzOzIgUmlvIFRvY2FudGluczszIEF0bMOibnRpY28sIFRyZWNobyBOb3J0ZS9Ob3JkZXN0ZTs0IFJpbyBTw6NvIEZyYW5jaXNjbzs1IEF0bMOibnRpY28sIFRyZWNobyBMZXN0ZTs2IFJpbyBQYXJhbsOhwqA7NyBSaW8gVXJ1Z3VhaTs4IEF0bMOibnRpY28sIFRyZWNobyBTdWRlc3RlOzkgT3V0cmFzOz47QDwwOzE7MjszOzQ7NTs2Ozc7ODs5Oz4+O2w8aTwwPjs+Pjs7Pjt0PHQ8O3Q8aTw4MT47QDxcPHRvZG9zXD47MTAgUklPIFNPTElNT0VTLCBKQVZBUkksSVRBQ1VBSTsxMSBSSU8gU09MSU1PRVMsSUNBLEpBTkRJQVRVQkEsLi47MTIgUklPIFNPTElNT0VTLEpVUlVBLEpBUFVSQSwuLi4uOzEzIFJJTyBTT0xJTU9FUyxQVVJVUyxDT0FSSSwuLjsxNCBSSU8gU09MSU1PRVMsTkVHUk8sQlJBTkNPLC4uLi47MTUgUklPIEFNQVpPTkFTLE1BREVJUkEsR1VBUE9SRSwuOzE2IFJJTyBBTUFaT05BUyxUUk9NQkVUQVMsT1VUUk9TOzE3IFJJTyBBTUFaT05BUyxUQVBBSk9TLEpVUlVFTkEuLjsxOCBSSU8gQU1BWk9OQVMsWElOR1UsSVJJUkksUEFSVTsxOSBSSU8gQU1BWk9OQVMsSkFSSSxQQVJBLE9VVFJPUzsyMCBSSU8gVE9DQU5USU5TLE1BUkFOSEFPLEFMTUFTLi47MjEgUklPIFRPQ0FOVElOUyxQQVJBTkEsUEFMTUEuLi4uOzIyIFJJTyBUT0NBTlRJTlMsTS4gQUxWRVMsU09OTy4uLjsyMyBSSU8gVE9DQU5USU5TLE0uIEFMVkVTIEdSQU5ERTsyNCBSSU8gQVJBR1VBSUEsQ0FJQVBPLENMQVJPLi4uLi47MjUgUklPIEFSQUdVQUlBLENSSVhBUy1BQ1UsUEVJWEU7MjYgUklPIEFSQUdVQUlBLE1PUlRFUyxKQVZBRVMuLi4uOzI3IFJJTyBBUkFHVUFJQSxDT0NPLFBBVSBEJ0FSQ08uLjsyOCBSSU8gQVJBR1VBSUEsTVVSSUNJWkFMLExPTlRSQTsyOSBSSU8gVE9DQU5USU5TLElUQUNBSVVOQVMsLi4uLi47MzAgUklPUyBPSUFQT1FVRSxBUkFHVUFSSSBFIC4uLi4uOzMxIFJJT1MgTUVSVVUsQUNBUkEsR1VBTUEsIE9VVFJPUzszMiBSSU9TIEdVUlVQSSxUVVJJQUNVIEUgT1VUUk9TOzMzIFJJT1MgTUVBUklNLElUQVBFQ1VSVSBFIE9VVFJPUzszNCBSSU8gUEFSTkFJQkE7MzUgUklPUyBBQ0FSQVUsUElSQU5KSSBFIE9VVFJPUzszNiBSSU8gSkFHVUFSSUJFOzM3IFJJT1MgQVBPREksUElSQU5IQVMgRSBPVVRST1M7MzggUklPUyBQQVJBSUJBLFBPVEVOSkkgRSBPVVRST1M7MzkgUklPUyBDQVBJQkFSSUJFLE1VTkRBVSBFIC4uLi4uOzQwIFJJT1MgU0FPIEZSQU5DSVNDTyxQQVJBT1BFQkEgRTs0MSBSSU9TIFNBTyBGUkFOQ0lTQ08sREFTIFZFTEhBUzs0MiBSSU9TIFNBTyBGUkFOQ0lTQ08sUEFSQUNBVFUgRTs0MyBSSU9TIFNBTyBGUkFOQ0lTQ08sVVJVQ1VJQSBFIC47NDQgUklPUyBTQU8gRlJBTkNJU0NPLFZFUkRFIEdSRDs0NSBSSU9TIFNBTyBGUkFOQ0lTQ08sQ0FSSU5IQU5IQTs0NiBSSU9TIFNBTyBGUkFOQ0lTQ08sR1JBTkRFIEUgLi47NDcgUklPUyBTQU8gRlJBTkNJU0NPLEpBQ0FSRSBFIC4uOzQ4IFJJT1MgU0FPIEZSQU5DSVNDTyxQQUpFVSBFIC4uLjs0OSBSSU9TIFNBTyBGUkFOQ0lTQ08sTU9YT1RPIEUgLi47NTAgUklPUyBWQVpBLUJBUlJJUyxJVEFQSUNVUlUgRSAuOzUxIFJJT1MgUEFSQUdVQUNVLEpFUVVJUklDQSBFIC4uLjs1MiBSSU8gREUgQ09OVEFTOzUzIFJJT1MgUEFSRE8sQ0FDSE9FSVJBIEUgT1VUUk9TOzU0IFJJTyBKRVFVSVRJTkhPTkhBOzU1IFJJT1MgTVVDVVJJLFNBTyBNQVRFVVMgRSAuLi4uOzU2IFJJTyBET0NFOzU3IFJJT1MgSVRBUEVNSVJJTSxJVEFCQVBPQU5BIEUgLjs1OCBSSU8gUEFSQUlCQSBETyBTVUw7NTkgUklPUyBNQUNBRSxTQU8gSk9BTyBFIE9VVFJPUzs2MCBSSU8gUEFSQU5BSUJBOzYxIFJJTyBHUkFOREU7NjIgUklPUyBQQVJBTkEsVElFVEUgRSBPVVRST1M7NjMgUklPUyBQQVJBTkEsUEFSRE8gRSBPVVRST1M7NjQgUklPUyBQQVJBTkEsUEFSQU5BUEFORU1BIEUgLi4uOzY1IFJJT1MgUEFSQU5BLElHVUFDVSBFIE9VVFJPUzs2NiBSSU9TIFBBUkFHVUFJLFNBTyBMT1VSRU5DTyBFIC47NjcgUklPUyBQQVJBR1VBSSxBUEEgRSBPVVRST1M7NjggUklPUyBQQVJBTkEsQ09SUklFTlRFUyBFIC4uLi4uOzY5IFJJT1MgUEFSQU5BLFRFUkNFUk8gRSBPVVRST1M7NzAgUklPIFBFTE9UQVM7NzEgUklPIENBTk9BUzs3MiBSSU9TIFVSVUdVQUksRE8gUEVJWEUgRSBPVVRST1M7NzMgUklPUyBVUlVHVUFJLENIQVBFQ08gRSBPVVRST1M7NzQgUklPUyBVUlVHVUFJLERBIFZBUlpFQSBFIC4uLi47NzUgUklPUyBVUlVHVUFJLElKVUkgRSBPVVRST1M7NzYgUklPUyBVUlVHVUFJLElCSUNVSSBFIE9VVFJPUzs3NyBSSU9TIFVSVUdVQUksUVVBUkFJIEUgT1VUUk9TOzc4IFJJT1MgVVJVR1VBSSBFIE9VVFJPUzs3OSBSSU8gVVJVR1VBSSwgTkVHUk8gRSBPVVRST1M7ODAgUklPUyBJVEFQQU5IQVUsSVRBTkhBRU0gRSAuLi4uOzgxIFJJTyBSSUJFSVJBIERPIElHVUFQRTs4MiBSSU9TIE5IVU5ESUFRVUFSQSxJVEFQT0NVIEUgLi47ODMgUklPIElUQUpBSS1BQ1U7ODQgUklPUyBUVUJBUkFPLEFSQVJBTkdVQSBFIC4uLi4uOzg1IFJJTyBKQUNVSTs4NiBSSU8gVEFRVUFSSTs4NyBMQUdPQSBET1MgUEFUT1M7ODggTEFHT0EgTUlSSU07OTAgT1VUUk9TIFJJT1M7PjtAPDA7MTA7MTE7MTI7MTM7MTQ7MTU7MTY7MTc7MTg7MTk7MjA7MjE7MjI7MjM7MjQ7MjU7MjY7Mjc7Mjg7Mjk7MzA7MzE7MzI7MzM7MzQ7MzU7MzY7Mzc7Mzg7Mzk7NDA7NDE7NDI7NDM7NDQ7NDU7NDY7NDc7NDg7NDk7NTA7NTE7NTI7NTM7NTQ7NTU7NTY7NTc7NTg7NTk7NjA7NjE7NjI7NjM7NjQ7NjU7NjY7Njc7Njg7Njk7NzA7NzE7NzI7NzM7NzQ7NzU7NzY7Nzc7Nzg7Nzk7ODA7ODE7ODI7ODM7ODQ7ODU7ODY7ODc7ODg7OTA7Pj47bDxpPDA+Oz4+Ozs+O3Q8cDxwPGw8VGV4dDs+O2w8MTQ5OTAwMDA7Pj47Pjs7Pjs+Pjs+PjtsPGxzdEVzdGFjYW87YnRBdHVhbGl6YXI7bHN0RGlzcG9uaXZlbDtsc3RPcmlnZW07bHN0QmFjaWE7bHN0U3ViQmFjaWE7Pj7qWEOqVYtT2GXSnbZD16OBTevDZw==", 0, 0);
			repository.save(Arrays.asList(
					xapuri,
					riobranco,
					abuna,
					morada,
					guajara,
					portovelho,
					manaus
					));
//		}
		
		
		if(summaryRepository.count() == 0){
			loadHistory(13600002L);
			loadHistory(15400000L);
			loadHistory(14990000L);
		}
		System.out.println("StationLoader: finished");
	}

	private void loadHistory(Long stationId) {
		System.out.println("StationLoader.loadHistory() " + stationId);
		Station station = repository.findOne(stationId);
		File historyFile = new File("data/history/" + station.id + ".csv");
		if(historyFile.exists() && historyFile.canRead()){
			try(Scanner input = new Scanner(historyFile);){
				while(input.hasNextLine()){
					String[] entry = input.nextLine().trim().split(",");
					String timestamp = entry[0].trim().split(" +")[0];
					Long value = "NA".equals(entry[1].trim())? null:
						Long.valueOf(entry[1].trim());
					summaryRepository.save(new Summary(station, timestamp, value));
				}
			} catch (FileNotFoundException e) {
				e.printStackTrace();
			}
		}
	}
}
